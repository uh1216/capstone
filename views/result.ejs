<!DOCTYPE html>
<html style="background-color: #242424" lang="en">
<head>
    <!-- <meta http-equiv="Content-Type" content="text/html;charset=UTF-8"> -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>댓글 분석 결과</title>
    
    <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="css/landing-page.min.css" rel="stylesheet">
    <link href="css/mycss.css" rel="stylesheet">
    <link href="css/result.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/jqcloud/1.0.4/jqcloud.css" rel="stylesheet"/>


    <script type="text/javascript" src="./js/main.js"></script>
    <script src="https://code.jquery.com/jquery-3.3.1.js" ></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jqcloud/1.0.4/jqcloud-1.0.4.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.min.js"></script>

</head>
<body>
     <div id = "heder">
        <div style="max-width: 100% !important; max-height: max-content; padding: 0px !important;"  class="container">
          <div class = "raw">
            <div id="result" class="rtitle">
              <h1 id="title">댓글 분석 결과</h1>
            </div>
            <div id = "result_page">
              <div class="templatebody1">
                <div class=maintext1>
                    <div class="maintext11">
                      <p class="text123">단어가 포함된 댓글 검색하기</p>
                      <div class = search_bar>
                        <form>
                          <div class="form-row">
                            <div class="col-12 col-md-9 mb-2 mb-md-0">
                              <input id = 'word' type="text" class="form-control form-control-lg" placeholder="단어를 입력해주세요">
                            </div>
                            <div style="display: flex;width: 100% !important;" class="btn-div col-12 col-md-3">
                              <button style="width: 35%;" type="button" onclick="search()" class="btn-new-sr">검색하기</button>
                            </div>
                          </div>
                        </form>
                      </div>
                    </div>
                    <div id = "ws_result_div">
                      <div id="ws_result"></div>
                    </div> 
                  </div>
                
                <div class="chartbox">
                  <div class="chartbox1">
                      <p class="text123"> 댓글에서 많이 나온 단어 상위 20개</p>
                          <canvas id="myChart" width="500" height="350"></canvas>
                  </div>  
                  <div class="chartbox2">
                    <div id="example" style="width: 100%; height: 100%;"></div>
                  </div>
                  <script>
                    var words = [];
                    '<% for(var i = 0; i < 20 ; i++) { %>'
                        words.push('<%= words[i] %>');
                    '<% } %>'
                    var word_array = [
                     {text: words[0], weight: 123},
                     {text: words[1], weight: 113},
                     {text: words[2], weight: 106},
                     {text: words[3], weight: 98},
                     {text: words[4], weight: 91},
                     {text: words[5], weight: 84},
                     {text: words[6], weight: 76},
                     {text: words[7], weight: 68},
                     {text: words[8], weight: 63},
                     {text: words[9], weight: 57},
                     {text: words[10], weight: 51},
                     {text: words[11], weight: 48},
                     {text: words[12], weight: 42},
                     {text: words[13], weight: 38},
                     {text: words[14], weight: 35},
                     {text: words[15], weight: 32},
                     {text: words[16], weight: 28},
                     {text: words[17], weight: 24},
                     {text: words[18], weight: 19},
                     {text: words[19], weight: 15},                     
                    ];
                    $('#example').jQCloud(word_array, {
                      
                    });                    
                  </script>
              </div>
                <div class="link1">
                  <div class="link12">
                      <div style="font-size: 30px;" class="text123"><p>좋아요가 높은 댓글 TOP 20</p></div>
                        <% for(var i = 0; i < 20 ; i++) { %>
                          <div class = "comment_div">
                            <div class="comment_head">                            
                                <h6><%= i + 1 %>. </h6>                            
                            </div>
                            <div class="comment_body">                          
                                <%= comments[i] %>
                            </div>
                          </div>
                        <% } %>
                      </div>
                  </div>
                  </div>
            </div>
        </div>
        
        <script>
            Chart.defaults.global.legend.display = false;
            var words = [];
            '<% for(var i = 0; i < 20 ; i++) { %>'
                words.push('<%= words[i] %>');
            '<% } %>'
            var ctx = document.getElementById("myChart"); 
            var myChart = new Chart(ctx, { 
              type: 'bar',
              data: { 
                labels: words, 
                datasets: [ 
                  { labels: "d",
                    data: [41, 39, 34, 31, 28, 25, 21, 20, 18, 16, 14, 13, 11, 9, 8, 6, 5, 4, 3, 2], 
                    backgroundColor :[
                            'rgba(255, 206, 86, 1)', 
                            'rgba(255, 206, 86, 0.95)', 
                            'rgba(255, 206, 86, 0.9)', 
                            'rgba(255, 206, 86, 0.85)', 
                            'rgba(255, 206, 86, 0.8)', 
                            'rgba(255, 206, 86, 0.75)', 
                            'rgba(255, 206, 86, 0.7)', 
                            'rgba(255, 206, 86, 0.65)', 
                            'rgba(255, 206, 86, 0.6)', 
                            'rgba(255, 206, 86, 0.55)', 
                            'rgba(255, 206, 86, 0.5)', 
                            'rgba(255, 206, 86, 0.45)', 
                            'rgba(255, 206, 86, 0.4)', 
                            'rgba(255, 206, 86, 0.35)', 
                            'rgba(255, 206, 86, 0.3)', 
                            'rgba(255, 206, 86, 0.25)', 
                            'rgba(255, 206, 86, 0.2)', 
                            'rgba(255, 206, 86, 0.15)', 
                            'rgba(255, 206, 86, 0.1)', 
                            'rgba(255, 206, 86, 0.05)',           
            ]
                  } 
                ] 
              }, 
              options: { 
                    scales: {
                      xAxes: [{
                          ticks: {
                              fontColor: "white",
                              fontSize: 15
                          }
                      }], 
                      yAxes: [{ 
                          ticks: { 
                              beginAtZero:true 
                          } 
                      }] 
                    } 
                } 
            });
        </script>
      </div>
      <script>            
            function search() {
                var ws_result = document.getElementById('ws_result');
                ws_result.innerHTML = '';
                const comment = [];
                const word = document.getElementById('word').value;
                var x = 1;
                '<% for(var i = 0; i < full_comments.length ; i++) { %>'
                    if('<%=full_comments[i]%>'.indexOf(word) != -1) {
                        comment.push('<%=full_comments[i]%>');

                        var make_div = document.createElement('div')
                        var make_head = document.createElement('div')
                        var make_body = document.createElement('div')

                        make_head.innerHTML = x + '.  ';
                        make_body.innerHTML = '<%=full_comments[i]%>';

                        make_div.setAttribute("class", "comment_r_div");
                        make_div.setAttribute("id", "comment_r_div" + x);
                        make_head.setAttribute("class", "comment_r_head");
                        make_body.setAttribute("class", "comment_r_body");    

                        ws_result.appendChild(make_div);
                        var con = document.getElementById('comment_r_div' + x);
                        con.appendChild(make_head);
                        con.appendChild(make_body);                        
                        x++;
                    }
               '<% } %>'
                document.getElementById('word').value = null;
                var open_div = document.getElementById('ws_result_div');
                open_div.style.display = 'block';
            }
      </script>
</body>
</html>